import{_ as T}from"./CLGDawxg.js";import{_ as A,e as E,a as L,c as H}from"./CMm00pzW.js";import{M as Z,d as J,r,k as Q,o as W,E as z,C as p,B as x,F as t,z as o,x as B,H as C,A as n,D as k,O as g,Q as V,P as y,R as N,S as $,y as w}from"./DMY3ICXA.js";import{a as q}from"./D48Ehzst.js";const G=Z("/svg/pig-computer.svg"),I={key:0},K={key:0},Y={value:"patek,sobota"},X={value:"patek"},ee={value:"sobota"},oe={value:"ne"},te={value:"vino"},ne={value:"pivo"},le={value:"tvrdej"},se={value:"cocktail"},ae={value:"nealko"},re=["disabled"],ue=J({__name:"ConfirmationForm",props:{t:{},sleeping:{type:Boolean}},setup(m){const O=m;q({title:O.t.confirmationForm.title+" | "+O.t.intro.soWellGetMarriedThen});const l=O.t.confirmationForm.fields,a=r(""),u=r(1),d=r(""),c=r("nealko"),f=r(O.sleeping?"patek,sobota":"x"),v=r(""),h=Q(()=>a.value.trim()!==""&&u.value>0),F=r(!1);W(()=>{F.value=R()});const P=r(!1);function U(){const b={name:a.value,numberOfPeople:u.value,contact:d.value,preferredDrink:c.value,sleepover:f.value,message:v.value};localStorage.setItem("confirmationForm",JSON.stringify(b)),F.value=!0}function R(){const b=localStorage.getItem("confirmationForm");if(b)try{const e=JSON.parse(b);return a.value=e.name??"",u.value=e.numberOfPeople??1,d.value=e.contact??"",c.value=e.preferredDrink??"nealko",f.value=e.sleepover??(O.sleeping?"patek,sobota":"x"),v.value=e.message??"",!0}catch(e){console.error("Error parsing saved form values:",e)}return!1}async function M(){const e=new URLSearchParams(window.location.search).get("password")||"",j={name:a.value,contact:d.value,personCount:u.value.toString(),sleeping:f.value,drink:c.value,message:v.value,password:e},D=new URLSearchParams(j);try{const i="https://script.google.com/macros/s/AKfycbyWfwHR2pNtCAgkEdTNSchV8lQwenpCrk9pc2VUkZWjYooBseH_GRuDF3Vtq0xKqc6JfQ/exec";P.value=!0;const S=await fetch(i,{method:"POST",body:D}),_=await S.json();if(S.ok){if(_.status==="created")return U(),alert(`Formulář byl úspěšně odeslán. Děkujeme, ${a.value}!`);if(_.status==="updated")return U(),alert(`Zaznamené odpovědi pro jméno "${a.value}" byly aktualizovány. Děkujeme!`);if(_.status==="wrong_password")return alert("Dobrý pokus, ale bez hesla to nepůjde! Vrať se zpět a zadej správné heslo");console.error("Unexpected response status:",_),alert("Omlouváme se, ale při odesílání formuláře došlo k chybě. Zkuste to prosím znovu později!")}}catch(i){console.error("Error submitting form:",i),alert("Omlouváme se, ale při odesílání formuláře došlo k chybě. Zkuste to prosím znovu později.")}finally{P.value=!1}}return(b,e)=>{const j=T,D=L,i=E,S=H,_=A;return w(),z(_,null,{default:p(()=>[x(D,{justify:"left",alignment:"top"},{default:p(()=>[x(j,{t:m.t},null,8,["t"])]),_:1}),x(S,{title:m.t.confirmationForm.title},{default:p(()=>[t(P)?(w(),z(i,{key:0,gap:"1",alignment:"center"},{default:p(()=>[...e[6]||(e[6]=[o("p",null,"Odesílám formulář...",-1),o("img",{src:G},null,-1)])]),_:1})):(w(),z(i,{key:1,gap:"2"},{default:p(()=>[t(F)?(w(),B("p",I,n(m.t.confirmationForm.alreadySubmitted),1)):C("",!0),o("form",{onSubmit:$(M,["prevent"])},[x(i,{gap:"1"},{default:p(()=>[o("label",null,[k(n(t(l).name)+" ",1),e[7]||(e[7]=o("br",null,null,-1)),g(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>y(a)?a.value=s:null),type:"text",name:"name",placeholder:"Prasátko Pepina"},null,512),[[V,t(a)]])]),o("label",null,[k(n(t(l).contact)+" ",1),e[8]||(e[8]=o("br",null,null,-1)),g(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>y(d)?d.value=s:null),type:"text",name:"contact"},null,512),[[V,t(d)]])]),o("label",null,[k(n(t(l).numberOfPeople)+" ",1),e[9]||(e[9]=o("br",null,null,-1)),g(o("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>y(u)?u.value=s:null),type:"number",name:"numberOfPeople"},null,512),[[V,t(u)]])]),m.sleeping?(w(),B("label",K,[k(n(t(l).sleepover)+" ",1),e[10]||(e[10]=o("br",null,null,-1)),g(o("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>y(f)?f.value=s:null),name:"sleepover"},[o("option",Y,n(t(l).sleepoverOptions.both),1),o("option",X,n(t(l).sleepoverOptions.friday),1),o("option",ee,n(t(l).sleepoverOptions.saturday),1),o("option",oe,n(t(l).sleepoverOptions.none),1)],512),[[N,t(f)]])])):C("",!0),o("label",null,[k(n(t(l).preferredDrink)+" ",1),e[11]||(e[11]=o("br",null,null,-1)),g(o("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>y(c)?c.value=s:null),name:"preferredDrink"},[o("option",te,n(t(l).preferredDrinkOptions.wine),1),o("option",ne,n(t(l).preferredDrinkOptions.beer),1),o("option",le,n(t(l).preferredDrinkOptions.sliwovitz),1),o("option",se,n(t(l).preferredDrinkOptions.cocktail),1),o("option",ae,n(t(l).preferredDrinkOptions.softDrink),1)],512),[[N,t(c)]])]),o("label",null,[k(n(t(l).message)+" ",1),e[12]||(e[12]=o("br",null,null,-1)),g(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>y(v)?v.value=s:null),name:"message",rows:"4",style:{width:"100%"}},null,512),[[V,t(v)]])]),x(D,{justify:"center",alignment:"center"},{default:p(()=>[o("button",{type:"submit",disabled:!t(h)},n(m.t.misc.submit),9,re)]),_:1})]),_:1})],32)]),_:1}))]),_:1},8,["title"])]),_:1})}}}),ce=Object.assign(ue,{__name:"ConfirmationForm"});export{ce as _};
